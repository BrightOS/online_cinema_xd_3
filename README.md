# Online Cinema Service Infrastructure

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –æ–Ω–ª–∞–π–Ω-–∫–∏–Ω–æ—Ç–µ–∞—Ç—Ä–∞. –ü—Ä–æ–µ–∫—Ç —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker Compose –∏ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —Å—Ç–µ–∫ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Observability), —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –º–µ–¥–∏–∞-–∫–æ–Ω—Ç–µ–Ω—Ç–∞.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—Å–∫–æ–º —Å–µ—Ä–≤–∏—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Makefile`.

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
make up
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
make down
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
make logs
```

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ Docker Compose:
```bash
docker-compose up -d
```

## –°–µ—Ä–≤–∏—Å—ã –∏ –ü–æ—Ä—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã:

### üìä Observability (–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¢—Ä–µ–π—Å–∏–Ω–≥)

| –°–µ—Ä–≤–∏—Å | URL / –ü–æ—Ä—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –õ–æ–≥–∏–Ω/–ü–∞—Ä–æ–ª—å |
|--------|------------|----------|--------------|
| **Grafana** | [http://localhost:3000](http://localhost:3000) | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ –ª–æ–≥–æ–≤. –î–∞—à–±–æ—Ä–¥—ã. | `admin` / `admin` |
| **Prometheus** | [http://localhost:9090](http://localhost:9090) | –°–±–æ—Ä –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫. | - |
| **Jaeger UI** | [http://localhost:16686](http://localhost:16686) | –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç—Ä–µ–π—Å–æ–≤ (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞). | - |

### üíæ Core Infrastructure (–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö)

| –°–µ—Ä–≤–∏—Å | –ü–æ—Ä—Ç | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Ö–æ—Å—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –ö—Ä–µ–¥—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) |
|--------|------|-----------------|----------|----------------------|
| **PostgreSQL** | `5432` | `postgres` | –•—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞–∫—Ç–µ—Ä–æ–≤. | `user` / `password`, DB: `cinema_db` |
| **Elasticsearch** | `9200` | `elasticsearch` | –ü–æ–∏—Å–∫–æ–≤—ã–π –¥–≤–∏–∂–æ–∫ –¥–ª—è —Ñ–∏–ª—å–º–æ–≤ –∏ –∞–∫—Ç–µ—Ä–æ–≤. | - |
| **MinIO (S3)** | `9000` (API), `9001` (UI) | `minio` | S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤. | `minioadmin` / `minioadmin` |

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: MinIO Console –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É [http://localhost:9001](http://localhost:9001).*

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API
- –ó–∞–π—Ç–∏ –≤ `movies`
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å `.env`
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å –ë–î —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–ø—Ç–∞ `init_db.py`
- –ó–∞–ø—É—Å—Ç–∏—Ç—å FastAPI: `uvicorn main:app --reload`

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Docker Compose
–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: `docker-compose.yml`.
–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–µ—Ç–∏, —Ç–æ–º–∞ (volumes) –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.
–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è:
- –°–µ—Ç—å: `cinema_net`
- –¢–æ–º–∞ –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö: `postgres_data`, `elasticsearch_data`, `minio_data`.

### Prometheus
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `deploy/prometheus/prometheus.yml`
- –ù–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ —Å —Å–∞–º–æ–≥–æ —Å–µ–±—è –∏ Jaeger.
- –î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –±–µ–∫–µ–Ω–¥–∞) –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ `job_name` –≤ `scrape_configs`.

### Grafana
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: `deploy/grafana/provisioning`
- **Datasources**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç Prometheus –∏ Jaeger –∫–∞–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`deploy/grafana/provisioning/datasources/datasources.yml`).

### MinIO
–ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä `createbuckets`, –∫–æ—Ç–æ—Ä—ã–π:
1. –ñ–¥–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ MinIO.
2. –°–æ–∑–¥–∞–µ—Ç –ø—É–±–ª–∏—á–Ω—ã–π –±–∞–∫–µ—Ç `movies` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
.
‚îú‚îÄ‚îÄ deploy/                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ grafana/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ provisioning/       # –ê–≤—Ç–æ-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Grafana (Datasources)
‚îÇ   ‚îî‚îÄ‚îÄ prometheus/             # –ö–æ–Ω—Ñ–∏–≥ Prometheus
‚îú‚îÄ‚îÄ docker-compose.yml          # –û–ø–∏—Å–∞–Ω–∏–µ –º—É–ª—å—Ç–∏-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–π –∞–ø–ø–ª–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ Makefile                    # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
‚îî‚îÄ‚îÄ README.md                   # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```
